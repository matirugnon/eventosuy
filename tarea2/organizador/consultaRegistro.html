<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Consulta de Registro · eventos.uy</title>
  <link rel="icon" type="image/png" href="../img/favicon.png">
  <link rel="stylesheet" href="../styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
</head>
<body>
  <div>
    <header class="header">
      <h1><a href="principalOrganizador.html" style="color: inherit; text-decoration: none;">eventos.uy</a></h1>
      <div class="header-right">
        <div class="user-badge" style="display: flex; align-items: center; gap: 0.5rem;">
          <a href="consultaPerfil.html" style="display: flex; align-items: center; gap: 0.5rem;">
            <img class="avatar" src="../img/IMG-US04.jpeg" alt="Avatar organizador" />
            <span class="nickname" id="nick">miseventos</span>
          </a>
        </div>
        <a href="../index.html" class="btn-primary">Cerrar sesión</a>
      </div>
    </header>
    <div class="content">
      <aside class="sidebar">
        <div class="panel sidebar">
          <div class="panel-header">Mi perfil</div>
          <ul class="menu-list" style="margin-bottom: 3rem;">
            <li><a href="altaEvento.html">Alta Evento</a></li>
            <li><a href="altaEdicion.html">Alta Edición</a></li>
            <li><a href="altaInstitucion.html">Alta Institución</a></li>
            <li><a href="altadeTipodeRegistro.html">Alta Tipo de Registro</a></li>
            <li><a href="edicionesOrganizadasEvento.html">Alta Patrocinio</a></li>
            <li><a href="consultaRegistro.html">Consulta Registro</a></li>
          </ul>
          <div class="panel-header">Categorías</div>
          <ul class="menu-list">
            <li><a href="tecnologiaOrganizador.html">Tecnología</a></li>
            <li><a href="innovacionOrganizador.html">Innovación</a></li>
            <li><a href="saludOrganizador.html">Salud</a></li>
            <li><a href="deporteOrganizador.html">Deporte</a></li>
          </ul>
        </div>
        <div style="margin-top: 2rem; border-top: 1px solid #e0e0e0; padding-top: 1rem;">
          <a href="listarUsuariosOrganizador.html" style="
              display: flex;
              align-items: center;
              gap: 0.5rem;
              font-weight: 600;
              text-decoration: none;
              padding: 0.75rem;
              border-radius: 6px;
              transition: background-color 0.2s;
              background-color: rgba(24, 32, 128, 0.05);">
            Ver listado de usuarios
          </a>
        </div>
      </aside>
      <main>
        <section class="panel" style="max-width:700px;margin:0 auto;">
          <div class="panel-header">Consulta de Registro</div>
          <div class="panel-body">
            <!-- Paso 1: Selección de edición -->
            <div id="step-edicion" class="consulta-registro-form-row">
              <label class="form-group" style="margin-bottom:0;">
                <span class="label-text">Seleccioná una edición</span>
              </label>
              <select id="edicionSelect" required>
                <option value="">Seleccionar…</option>
                <option value="EDEV03">Maratón de Montevideo 2024</option>
                <option value="EDEV08">Tecnología Punta del Este 2026</option>
                <option value="EDEV10">Web Summit 2026</option>
              </select>
            </div>

            <!-- Paso 2: Listado de usuarios registrados -->
            <div id="step-usuarios" class="consulta-registro-form-row" style="display:none;">
              <label class="form-group" style="margin-bottom:0;">
                <span class="label-text">Usuarios registrados en la edición</span>
              </label>
              <select id="usuarioSelect" required>
                <option value="">Seleccionar…</option>
                <!-- Se completa según la edición (solo 'atorres' en EDEV03 y EDEV10) -->
              </select>
            </div>

            <!-- Paso 3: Detalle del registro -->
            <div id="step-detalle" style="display:none;">
              <div class="panel" style="background:#f8f9ff;">
                <div class="panel-header" style="color:#182080;">Detalle del registro</div>
                <div class="panel-body">
                  <p><strong>Registro:</strong> <span id="refRegistro">—</span></p>
                  <p><strong>Usuario:</strong> <span id="usuarioNombre">—</span></p>
                  <p><strong>Tipo de registro:</strong> <span id="tipoRegistro">—</span></p>
                  <p><strong>Fecha de registro:</strong> <span id="fechaRegistro">—</span></p>
                  <p><strong>Costo:</strong> <span id="costoRegistro">—</span></p>
                </div>
              </div>
            </div>

            <div style="margin-top:1.5rem;">
              <a class="btn-outline" href="principalOrganizador.html">← Volver</a>
            </div>
          </div>
        </section>
      </main>
    </div>
  </div>

  <script>
    // Datos oficiales (solo atorres y solo dos registros válidos)
    // EDEV08 no tiene registros → no habrá usuarios para seleccionar
    const registros = {
      'EDEV03': [
        { id: 'US01', nick: 'atorres', ref: 'RE02', tipoRef: 'TR07', tipoNombre: 'Corredor 21K', fecha: '30/07/2024', costo: 500 }
      ],
      'EDEV10': [
        { id: 'US01', nick: 'atorres', ref: 'RE03', tipoRef: 'TR25', tipoNombre: 'Estudiante',  fecha: '21/08/2025', costo: 300 }
      ],
      'EDEV08': [] // sin registros
    };

    const edicionSelect   = document.getElementById('edicionSelect');
    const usuarioSelect   = document.getElementById('usuarioSelect');
    const stepUsuarios    = document.getElementById('step-usuarios');
    const stepDetalle     = document.getElementById('step-detalle');

    const refRegistroEl   = document.getElementById('refRegistro');
    const usuarioNombreEl = document.getElementById('usuarioNombre');
    const tipoRegistroEl  = document.getElementById('tipoRegistro');
    const fechaRegistroEl = document.getElementById('fechaRegistro');
    const costoRegistroEl = document.getElementById('costoRegistro');

    edicionSelect.addEventListener('change', function () {
      const ed = edicionSelect.value;

      // Reset UI
      usuarioSelect.innerHTML = '<option value="">Seleccionar…</option>';
      stepDetalle.style.display = 'none';

      // Sin edición o sin registros → ocultar usuarios y terminar
      if (!ed || !registros[ed] || registros[ed].length === 0) {
        stepUsuarios.style.display = 'none';
        return;
      }

      // Cargar solo atorres para EDEV03 y EDEV10
      registros[ed].forEach(u => {
        const opt = document.createElement('option');
        opt.value = u.id;  // US01
        opt.textContent = `${u.nick}`;
        usuarioSelect.appendChild(opt);
      });

      stepUsuarios.style.display = '';
    });

    usuarioSelect.addEventListener('change', function () {
      const ed = edicionSelect.value;
      const usu = usuarioSelect.value; // US01
      if (!ed || !usu) {
        stepDetalle.style.display = 'none';
        return;
      }
      const reg = (registros[ed] || []).find(r => r.id === usu);
      if (!reg) { stepDetalle.style.display = 'none'; return; }

      // Mostrar detalles correctos del registro
      refRegistroEl.textContent   = reg.ref;
      usuarioNombreEl.textContent = `${reg.nick} (${reg.id})`;
      tipoRegistroEl.textContent  = `${reg.tipoRef} — ${reg.tipoNombre}`;
      fechaRegistroEl.textContent = reg.fecha;
      costoRegistroEl.textContent = `$ ${reg.costo}`;

      stepDetalle.style.display = '';
    });
  </script>
</body>
</html>

