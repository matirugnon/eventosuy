<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Alta de Patrocinio · eventos.uy</title>
<link rel="stylesheet" href="../styles.css" />
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet" />
<style>
  .info-box {
    border: 1px solid #ddd;
    padding: 1rem;
    margin-top: 0.5rem;
    background: #f9f9f9;
    border-radius: 6px;
  }

  #formDetalles {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .hidden {
    display: none !important;
  }
</style>
  

</head>
<body>
<header class="header">
  <h1>eventos.uy</h1>
  <div class="header-right">
    <div class="user-badge" style="display: flex; align-items: center; gap: 0.5rem;">
      <img src="../img/organizador.png" alt="Organizador" class="avatar" />
      <span class="nickname">organizador1</span>
      <a href="#" class="btn-primary">Cerrar sesión</a>
    </div>
  </div>
</header>

<div class="content single">
  <main>
    <section class="panel">
      <h2>Alta de Patrocinio</h2>
      <form id="formPatrocinio" novalidate>
        <!-- Edición fija, oculta -->
        <input type="hidden" name="edicion" value="MARATON2022" />

        <!-- Selector tipo de registro -->
			<label class="form-group">
  				<span class="label-text">Tipo de registro *</span>
  				<select id="tipoRegistro" name="tipoRegistro" required>
    				<option value="">Seleccionar tipo de registro…</option>
    				<option value="corredor10k">Corredor 10k</option>
    				<option value="corredor21k">Corredor 21k</option>
    				<option value="corredor42k">Corredor 42k</option>
  				</select>
			</label>
			

      

          <!-- Info tipo registro -->
		<div id="infoTipoRegistro" class="info-box hidden">
  <h3>Descripción</h3>

  <div id="desc-corredor10k" class="desc-tipo hidden" style="white-space: pre-wrap;">
    Participación en carrera de 10 kilómetros. Ideal para corredores principiantes.
    <p><strong>Costo:</strong> 300.00 UYU</p>
    <p><strong>Cupo:</strong> 150</p>
  </div>

  <div id="desc-corredor21k" class="desc-tipo hidden" style="white-space: pre-wrap;">
    Participación en media maratón de 21 kilómetros. Nivel intermedio.
    <p><strong>Costo:</strong> 750.00 UYU</p>
    <p><strong>Cupo:</strong> 250</p>
  </div>

  <div id="desc-corredor42k" class="desc-tipo hidden" style="white-space: pre-wrap;">
    Participación en maratón completa de 42 kilómetros. Nivel avanzado.
    <p><strong>Costo:</strong> 1200.00 UYU</p>
    <p><strong>Cupo:</strong> 100</p>
  </div>
</div>
		
		
		
		  <!-- Todo lo demás oculto inicialmente -->
        <div id="formDetalles" class="hidden">

          <!-- Institución -->
          <label class="form-group" for="institucion">
            <span class="label-text">Institución *</span>
            <select id="institucion" name="institucion" required>
              <option value="">Seleccione una institución…</option>
              <option value="institucion1">Institución 1</option>
              <option value="institucion2">Institución 2</option>
              <option value="institucion3">Institución 3</option>
            </select>
          </label>

          <!-- Nivel patrocinio -->
          <label class="form-group" for="nivelPatrocinio">
            <span class="label-text">Nivel de Patrocinio *</span>
            <select id="nivelPatrocinio" name="nivelPatrocinio" required>
              <option value="">Seleccione nivel…</option>
              <option value="platino">Platino</option>
              <option value="oro">Oro</option>
              <option value="plata">Plata</option>
              <option value="bronce">Bronce</option>
            </select>
          </label>

          <!-- Aporte económico -->
          <label class="form-group" for="aporteEconomico">
            <span class="label-text">Aporte Económico (UYU) *</span>
            <input id="aporteEconomico" name="aporteEconomico" type="number" min="0" step="0.01" placeholder="Ej. 10000" required />
          </label>

          <!-- Registros gratuitos -->
          <label class="form-group" for="registrosGratuitos">
            <span class="label-text">Cantidad de registros gratuitos *</span>
            <input id="registrosGratuitos" name="registrosGratuitos" type="number" min="0" step="1" placeholder="Ej. 10" required />
          </label>

          <!-- Código patrocinio -->
          <label class="form-group" for="codigoPatrocinio">
            <span class="label-text">Código de Patrocinio *</span>
            <input id="codigoPatrocinio" name="codigoPatrocinio" type="text" maxlength="20" placeholder="Código único" required />
          </label>
		</div>
          
          <div id="msg" style="color:#c00; margin-top:1rem; min-height:1.5rem;"></div>

          <div style="margin-top:1rem; display: flex; gap: 1rem; justify-content: center;">
            <button type="submit" class="btn-primary" style="flex: 1;">Crear patrocinio</button>
            <button type="button" class="btn-outline" onclick="window.location.href='index.html'">Cancelar</button>
          </div>
        
      </form>
    </section>
  </main>
</div>

<script>
(() => {
	  const tipoRegistroSelect = document.getElementById('tipoRegistro');
	  const formDetalles = document.getElementById('formDetalles');
	  const infoTipoRegistroDiv = document.getElementById('infoTipoRegistro');
	  const msg = document.getElementById('msg');

	  const descTipos = document.querySelectorAll('.desc-tipo');

	  tipoRegistroSelect.addEventListener('change', () => {
	    const seleccionado = tipoRegistroSelect.value;

	    // Oculto todo por defecto
	    descTipos.forEach(div => div.classList.add('hidden'));

	    if (seleccionado) {
	      // Mostrar info general y el div específico
	      infoTipoRegistroDiv.classList.remove('hidden');
	      formDetalles.classList.remove('hidden');

	      const divMostrar = document.getElementById(`desc-${seleccionado}`);
	      if (divMostrar) divMostrar.classList.remove('hidden');
	    } else {
	      infoTipoRegistroDiv.classList.add('hidden');
	      formDetalles.classList.add('hidden');
	    }

	    msg.textContent = '';
	  });

	  document.getElementById('formPatrocinio').addEventListener('submit', e => {
		  e.preventDefault();
		  msg.style.color = '#c00';
		  msg.textContent = '';

		  const form = e.target;

		  if (!form.checkValidity()) {
		    form.reportValidity();
		    msg.textContent = 'Por favor complete todos los campos correctamente.';
		    return;
		  }

		  const tipoRegistro = tipoRegistroSelect.value;
		  const aporte = parseFloat(form.aporteEconomico.value);
		  const registrosGratis = parseInt(form.registrosGratuitos.value);

		  const costos = {
		    corredor10k: 300,
		    corredor21k: 750,
		    corredor42k: 1200
		  };

		  const costoRegistro = costos[tipoRegistro];

		  if (registrosGratis * costoRegistro > aporte * 0.20) {
		    msg.textContent = '⚠️ El costo de los registros gratuitos supera el 20% del aporte económico.';
		    return;
		  }

		  msg.style.color = '#2a7f2e';
		  msg.textContent = '✅ Patrocinio registrado correctamente (simulado).';

		  setTimeout(() => {
		    window.location.href = 'edicionesOrganizadasEvento.html';
		  }, 1500);
		});

		// Botón cancelar
		document.querySelector('.btn-outline').addEventListener('click', () => {
		  window.location.href = 'edicionesOrganizadasEvento.html';
		});


	})();

</script>

</body>
</html>
